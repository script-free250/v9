<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>╪и┘И╪з╪и╪й ╪з┘Д╪п╪о┘И┘Д ╪з┘Д╪в┘Е┘Ж╪й | V9</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* =========================================
           ╪к┘Ж╪│┘К┘В╪з╪к ╪┤╪з╪┤╪й ╪з┘Д╪е┘В┘Д╪з╪╣ (Plane Theme)
        ========================================= */
        .loader-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #050505;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s ease-in-out;
            background-image: radial-gradient(circle at center, rgba(0, 255, 65, 0.05) 0%, #000 70%);
        }
        
        /* ╪з┘Д┘Д┘И╪м┘И ╪з┘Д╪▒╪ж┘К╪│┘К */
        .loader-logo {
            width: 140px;
            filter: drop-shadow(0 0 15px rgba(0, 255, 65, 0.3));
            animation: breatheLogo 3s ease-in-out infinite;
            margin-bottom: 40px;
        }
        @keyframes breatheLogo {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 15px rgba(0, 255, 65, 0.3)); }
            50% { transform: scale(1.05); filter: drop-shadow(0 0 30px rgba(0, 255, 65, 0.6)); }
        }

        /* ╪н╪з┘И┘К╪й ╪┤╪▒┘К╪╖ ╪з┘Д╪к╪н┘Е┘К┘Д */
        .progress-container {
            width: 80%;
            max-width: 300px;
            position: relative;
            height: 4px;
            background: #222;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        /* ╪┤╪▒┘К╪╖ ╪з┘Д╪к┘В╪п┘Е */
        .progress-bar {
            height: 100%;
            background: var(--hacker-green);
            width: 0%;
            border-radius: 4px;
            position: relative;
            box-shadow: 0 0 10px var(--hacker-green);
            transition: width 0.1s linear;
        }

        /* ╪г┘К┘В┘И┘Ж╪й ╪з┘Д╪╖╪з╪ж╪▒╪й (Plane) */
        .plane-head {
            position: absolute;
            top: 50%;
            left: 100%; /* ╪к╪к╪и╪╣ ┘Ж┘З╪з┘К╪й ╪з┘Д╪┤╪▒┘К╪╖ */
            /* ╪к╪п┘И┘К╪▒ ╪з┘Д╪╖╪з╪ж╪▒╪й ┘В┘Д┘К┘Д╪з┘Л ┘Д┘Д╪г╪╣┘Д┘Й ┘Д╪к╪и╪п┘И ┘И┘Г╪г┘Ж┘З╪з ╪к┘В┘Д╪╣ */
            transform: translate(-50%, -55%) rotate(-10deg); 
            font-size: 1.8rem;
            filter: drop-shadow(0 0 8px var(--hacker-green));
            transition: left 0.1s linear;
        }

        /* ╪з┘Д┘Ж╪╡ ╪г╪│┘Б┘Д ╪з┘Д╪к╪н┘Е┘К┘Д */
        .loading-text {
            font-family: 'Cairo', sans-serif;
            color: #888;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            min-height: 20
        }

        /* =========================================
           ╪к┘Ж╪│┘К┘В╪з╪к ╪з┘Д╪╡┘Б╪н╪й ╪з┘Д╪▒╪ж┘К╪│┘К╪й
        ========================================= */
        #mainContainer { opacity: 0; transition: opacity 1s ease; }
        #mainContainer.visible { opacity: 1; }
    </style>
</head>
<body>

    <div id="loaderScreen" class="loader-overlay">
        <img src="11zon_cropped.png" alt="System Logo" class="loader-logo">
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">
                <div class="rocket-head">ЁЯЪА</div>
            </div>
        </div>

        <div class="loading-text" id="loadingStatus">╪м╪з╪▒┘К ╪к┘З┘К╪ж╪й ╪з┘Д┘Ж╪╕╪з┘Е...</div>
    </div>
    <div id="loginModal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" id="modalTitle">[ ╪к┘Ж╪и┘К┘З ╪з┘Д┘Ж╪╕╪з┘Е ]</div>
            <div class="modal-msg" id="modalMsg">...</div>
            <div class="modal-actions"><button class="modal-btn" onclick="closeModal()">┘Е┘И╪з┘Б┘В</button></div>
        </div>
    </div>

    <div class="container" id="mainContainer" style="display: none;">
        <img src="11zon_cropped.png" alt="App Logo" class="pro-logo" id="targetLogo">
        
        <div style="text-align: center; margin-bottom: 20px;">
            <h2 style="margin: 0;">╪и┘И╪з╪и╪й ╪з┘Д╪п╪о┘И┘Д</h2>
            <div style="font-family: 'Fira Code'; font-size: 0.7rem; color: #888; margin-top: 5px;">
                ┘Ж╪╕╪з┘Е MMX ┘Д┘Д╪к╪н┘Д┘К┘Д | ╪з┘Д╪е╪╡╪п╪з╪▒ V9.5
            </div>
        </div>
        
        <div class="input-wrapper">
            <input type="text" id="accessCode" placeholder="╪г╪п╪о┘Д ┘Г┘И╪п ╪з┘Д╪к┘Б╪╣┘К┘Д (Access Key)" 
                   style="text-align: center; font-weight: bold; font-family:'Fira Code'; letter-spacing:2px; text-transform:uppercase;">
        </div>

        <button id="loginBtn">╪п╪о┘И┘Д ┘Д┘Д┘Ж╪╕╪з┘Е</button>
        <button class="secondary-btn" onclick="window.location.href='create.html'" style="width:100%;">╪╖┘Д╪и ┘Г┘И╪п ╪к┘Б╪╣┘К┘Д ╪м╪п┘К╪п</button>
        
        <div class="status-bar">
            <div class="status-item"><div class="blink-dot"></div> ╪з┘Д╪│┘К╪▒┘Б╪▒: ┘Е╪к╪╡┘Д</div>
            <div class="status-item">Ping: <span id="pingVal">--ms</span></div>
        </div>

        <p id="vpnWarning" style="color: var(--warning-orange); font-size: 0.8rem; margin-top: 10px; display: none; border: 1px dashed var(--warning-orange); padding: 5px;">
            тЪая╕П ╪к╪н╪░┘К╪▒ ╪г┘Е┘Ж┘К: ┘К╪▒╪м┘Й ╪е╪║┘Д╪з┘В ╪з┘Д┘А VPN ┘Д╪╢┘Е╪з┘Ж ╪з╪│╪к┘В╪▒╪з╪▒ ╪з┘Д╪з╪к╪╡╪з┘Д.
        </p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://zflgifemhopabfzgczgs.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_9xZcd3BkgL6cEQwHJitrew_mbX74lJW';
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playTone(freq, type='sine', len=0.1, vol=0.1) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.type = type; osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            osc.start(); osc.stop(audioCtx.currentTime + len);
        }

        function showModal(title, msg) { document.getElementById('modalTitle').innerText = title; document.getElementById('modalMsg').innerText = msg; document.getElementById('loginModal').classList.add('active'); playTone(150, 'sawtooth', 0.3); }
        function closeModal() { document.getElementById('loginModal').classList.remove('active'); }
        function shakeScreen() { const c = document.getElementById('mainContainer'); c.classList.add('shake-element'); setTimeout(()=>c.classList.remove('shake-element'),500); }

        function checkVPN() {
            const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            if (timeZone !== "Africa/Cairo" && timeZone !== "Asia/Riyadh") { 
                document.getElementById('vpnWarning').style.display = 'block';
            }
        }

        setInterval(() => {
            document.getElementById('pingVal').innerText = Math.floor(Math.random() * 60 + 20) + 'ms';
        }, 2000);

        // ==================================================
        // === ╪п╪з┘Д╪й ╪к╪┤╪║┘К┘Д ╪┤╪з╪┤╪й ╪з┘Д╪к╪н┘Е┘К┘Д (Rocket Loader) ===
        // ==================================================
        function startLoadingSequence() {
            const bar = document.getElementById('progressBar');
            const status = document.getElementById('loadingStatus');
            const loaderScreen = document.getElementById('loaderScreen');
            const mainContainer = document.getElementById('mainContainer');
            
            let width = 0;
            const totalTime = 3000; // 3 ╪л┘И╪з┘Ж┘К ┘Е╪п╪й ╪з┘Д╪к╪н┘Е┘К┘Д
            const intervalTime = 30;
            const step = 100 / (totalTime / intervalTime);

            const interval = setInterval(() => {
                width += step;
                if (width > 100) width = 100;
                
                bar.style.width = width + '%';

                // ╪к╪н╪п┘К╪л ╪з┘Д┘Ж╪╡┘И╪╡ ╪н╪│╪и ╪з┘Д╪к┘В╪п┘Е
                if(width > 20 && width < 50) status.innerText = "╪м╪з╪▒┘К ╪з┘Д╪з╪к╪╡╪з┘Д ╪и┘В╪з╪╣╪п╪й ╪з┘Д╪и┘К╪з┘Ж╪з╪к...";
                else if(width > 50 && width < 80) status.innerText = "╪з┘Д╪к╪н┘В┘В ┘Е┘Ж ╪з┘Д╪к╪н╪п┘К╪л╪з╪к ╪з┘Д╪г┘Е┘Ж┘К╪й...";
                else if(width > 80) status.innerText = "╪з┘Г╪к┘Е╪з┘Д ╪з┘Д╪к╪н┘Е┘К┘Д...";

                if (width >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        // ╪е╪о┘Б╪з╪б ╪┤╪з╪┤╪й ╪з┘Д╪к╪н┘Е┘К┘Д
                        loaderScreen.style.opacity = '0';
                        playTone(600, 'sine', 0.3, 0.2); // ╪╡┘И╪к ╪з┘Д╪з┘Ж╪к┘З╪з╪б

                        setTimeout(() => {
                            loaderScreen.remove();
                            mainContainer.style.display = 'block';
                            setTimeout(() => mainContainer.classList.add('visible'), 50);
                        }, 800);
                    }, 500);
                }
            }, intervalTime);
        }

        // ╪к╪┤╪║┘К┘Д ╪з┘Д┘Ж╪╕╪з┘Е
        async function checkBan() {
            checkVPN();
            try {
                // ┘Е╪н╪з┘И┘Д╪й ╪з╪к╪╡╪з┘Д ┘И┘З┘Е┘К╪й ┘Д┘Д╪к╪н┘В┘В
                // const res = await fetch('https://api.ipify.org?format=json');
                startLoadingSequence();
            } catch (e) { 
                startLoadingSequence(); 
            }
        }
        window.onload = checkBan;

        async function runLogin() {
            const codeInput = document.getElementById('accessCode').value.trim();
            const btn = document.getElementById('loginBtn');
            if (!codeInput) { showModal("╪к┘Ж╪и┘К┘З", "┘К╪▒╪м┘Й ┘Г╪к╪з╪и╪й ╪з┘Д┘Г┘И╪п ╪з┘Д╪о╪з╪╡ ╪и┘Г."); shakeScreen(); return; }
            
            btn.innerText = "╪м╪з╪▒┘К ╪з┘Д╪к╪н┘В┘В..."; btn.disabled = true;

            setTimeout(async () => {
                try {
                    const { data } = await _supabase.from('active_codes').select('*').eq('code', codeInput).single();
                    if (!data) {
                        showModal("╪о╪╖╪г ┘Б┘К ╪з┘Д┘Г┘И╪п", "╪з┘Д┘Г┘И╪п ╪з┘Д╪░┘К ╪г╪п╪о┘Д╪к┘З ╪║┘К╪▒ ╪╡╪н┘К╪н.");
                        shakeScreen();
                    } else if (data.is_active === true) {
                        localStorage.setItem('isLoggedIn', 'true'); window.location.href = 'app.html';
                    } else {
                        showModal("╪║┘К╪▒ ┘Е┘Б╪╣┘Д", "╪з┘Д┘Г┘И╪п ╪╡╪н┘К╪н ┘И┘Д┘Г┘Ж┘З ╪и╪з┘Ж╪к╪╕╪з╪▒ ╪к┘Б╪╣┘К┘Д ╪з┘Д┘Е╪┤╪▒┘Б.");
                    }
                } catch (err) { showModal("╪о╪╖╪г ╪┤╪и┘Г╪й", "╪к╪г┘Г╪п ┘Е┘Ж ╪з╪к╪╡╪з┘Д┘Г ╪и╪з┘Д╪е┘Ж╪к╪▒┘Ж╪к."); shakeScreen(); } 
                finally { btn.innerText = "╪п╪о┘И┘Д ┘Д┘Д┘Ж╪╕╪з┘Е"; btn.disabled = false; }
            }, 1000);
        }
        document.getElementById('loginBtn').addEventListener('click', runLogin);
    </script>
</body>
</html>
